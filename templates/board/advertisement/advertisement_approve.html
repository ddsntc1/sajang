<!-- advertisement_approve.html -->
{% extends "base.html" %}
{% block content %}
<div class="container my-4">
    <div class="d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4">
        <div>
            <p class="text-uppercase text-muted small fw-bold mb-1" style="letter-spacing: .08em;">Admin</p>
            <h3 class="fw-bold mb-0">광고 검토/승인</h3>
            <p class="text-muted mb-0">광고 배너와 링크를 확인 후 승인 상태를 변경하세요.</p>
        </div>
        <span class="status-pill status-{{ advertisement.status }}">{{ advertisement.get_status_display }}</span>
    </div>

    <!-- 게시글 및 광고 정보 -->
    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-start flex-wrap gap-3">
                <div>
                    <div class="text-muted small mb-1">게시글</div>
                    <h5 class="fw-bold mb-2">{{ advertisement.question.subject }}</h5>
                    <div class="text-muted small">작성자 {{ advertisement.question.author.username }} · 등록일 {{ advertisement.created_at|date:"Y-m-d" }}</div>
                </div>
                <a href="{% url 'board:detail' question_id=advertisement.question.id %}" class="btn btn-outline-custom btn-sm">게시글 보기</a>
            </div>
            <div class="mt-3 text-muted">{{ advertisement.question.content|safe }}</div>
        </div>
    </div>

    <div class="row g-3 mb-4">
        <div class="col-lg-6">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="fw-bold mb-0">메인 배너</h6>
                        {% if advertisement.main_banner %}
                        <a href="{{ advertisement.main_banner.url }}" target="_blank" class="small text-muted">원본 보기</a>
                        {% endif %}
                    </div>
                    {% if advertisement.main_banner %}
                        <img src="{{ advertisement.main_banner.url }}" class="img-fluid rounded shadow-sm">
                    {% else %}
                        <div class="text-center text-muted py-4 border rounded">업로드된 메인 배너가 없습니다.</div>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="col-lg-6">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-center mb-2">
                        <h6 class="fw-bold mb-0">사이드 배너</h6>
                        {% if advertisement.side_banner %}
                        <a href="{{ advertisement.side_banner.url }}" target="_blank" class="small text-muted">원본 보기</a>
                        {% endif %}
                    </div>
                    {% if advertisement.side_banner %}
                        <img src="{{ advertisement.side_banner.url }}" class="img-fluid rounded shadow-sm">
                    {% else %}
                        <div class="text-center text-muted py-4 border rounded">업로드된 사이드 배너가 없습니다.</div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow-sm border-0 mb-4">
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <h6 class="fw-bold mb-0">외부 링크</h6>
                {% if advertisement.external_link %}
                <a href="{{ advertisement.external_link }}" target="_blank" class="small text-muted">새 창에서 열기</a>
                {% endif %}
            </div>
            {% if advertisement.external_link %}
            <div class="p-3 rounded border bg-light text-break small">{{ advertisement.external_link }}</div>
            {% else %}
            <div class="text-muted small">등록된 링크가 없습니다.</div>
            {% endif %}
        </div>
    </div>

    <!-- 승인 관리 폼 -->
    <form method="post" class="card shadow-sm border-0">
        {% csrf_token %}
        <div class="card-body">
            {% if form.errors %}
            <div class="alert alert-danger">
                {{ form.errors }}
            </div>
            {% endif %}

            <div class="row g-3">
                <div class="col-md-4">
                    <label for="{{ form.status.id_for_label }}" class="form-label fw-semibold">처리 상태</label>
                    {{ form.status }}
                </div>
                <div class="col-md-4">
                    <label for="{{ form.start_date.id_for_label }}" class="form-label fw-semibold">시작일</label>
                    {{ form.start_date }}
                </div>
                <div class="col-md-4">
                    <label for="{{ form.end_date.id_for_label }}" class="form-label fw-semibold">종료일</label>
                    {{ form.end_date }}
                </div>
                <div class="col-12">
                    <label for="{{ form.admin_message.id_for_label }}" class="form-label fw-semibold">관리자 메시지</label>
                    {{ form.admin_message }}
                </div>
            </div>

            <div class="text-end mt-4">
                <a href="{% url 'board:advertisement_list' %}" class="btn btn-outline-custom">취소</a>
                <button type="submit" class="btn btn-primary-custom ms-2">저장</button>
            </div>
        </div>
    </form>
</div>
{% endblock %}

{% block script %}
<style>
    .status-pill {
        display: inline-flex;
        align-items: center;
        padding: 0.4rem 0.9rem;
        border-radius: 999px;
        font-weight: 700;
        font-size: 0.9rem;
    }
    .status-pending { background: #fff4e5; color: #c05621; }
    .status-approved { background: #e3f9e5; color: #0f9d58; }
    .status-rejected { background: #ffe6e6; color: #d93025; }
    .status-ended { background: #f1f5f9; color: #475569; }
    form select, form input, form textarea {
        width: 100%;
    }
</style>
{% endblock %}
