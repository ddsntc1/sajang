{% extends "base.html" %}
{% block content %}

<div class="container my-3">
    <div class="row my-3">
        <div class="col-4">
            <h4>회원가입</h4>
        </div>
        <div class="col-8 text-right">
            <span>또는 <a href="{%url 'common:login'%}">로그인 하세요.</a></span>
        </div>
    </div>
    <form method="post" class="post-form">
        {% csrf_token %}
        {% include "form_errors.html" %}
        <div class="form-group">
            <label for="username">닉네임</label>
            <input type="text" name="username" id="username" class="form-control" value="{{form.username.value|default_if_none:''}}">
        </div>
        <div class="form-group">
            <label for="user_id">아이디</label>
            <input type="text" name="user_id" id="user_id" class="form-control" value="{{form.user_id.value|default_if_none:''}}">
        </div>
        <div class="form-group">
            <label for="password1">비밀번호</label>
            <input type="password" name="password1" id="password1" class="form-control" value="{{form.password1.value|default_if_none:''}}">
        </div>
        <div class="form-group">
            <label for="password2">비밀번호 확인</label>
            <input type="password" name="password2" id="password2" class="form-control" value="{{form.password2.value|default_if_none:''}}">
        </div>
        <div class="form-group">
            <label for="email">이메일</label>
            <input type="text" name="email" id="email" class="form-control" value="{{form.email.value|default_if_none:''}}">
        </div>
        <div class="form-group">
            <label for="category">사업 분야</label>
            <select name="category" id="category" class="form-control">
                <option value="">분야를 선택해주세요</option>
                {% for category in categories %}
                    <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="business_type">세부 업종</label>
            <select name="business_type" id="business_type" class="form-control" disabled>
                <option value="">사업 분야를 선택해주세요</option>
            </select>
        </div>
        <div class="form-group">
            <label for="business_name">사업장 이름</label>
            <input type="text" name="business_name" id="business_name" class="form-control" value="{{form.business_name.value|default_if_none:''}}" placeholder="선택사항">
        </div>
        <button type="submit" class="btn btn-primary">생성하기</button>
    </form>
</div>

<script>
document.getElementById('category').addEventListener('change', function() {
    const categoryId = this.value;
    const businessTypeSelect = document.getElementById('business_type');
    
    if (!categoryId) {
        businessTypeSelect.disabled = true;
        businessTypeSelect.innerHTML = '<option value="">먼저 사업 분야를 선택해주세요</option>';
        return;
    }

    // AJAX로 해당 카테고리의 business_type 목록을 가져옴
    fetch(`/common/get_business_types/${categoryId}/`)
        .then(response => response.json())
        .then(data => {
            businessTypeSelect.disabled = false;
            businessTypeSelect.innerHTML = '<option value="">업종을 선택해주세요</option>';
            data.forEach(type => {
                businessTypeSelect.innerHTML += `<option value="${type.id}">${type.name}</option>`;
            });
        });
});
</script>



<style>
    /* 컨테이너 스타일 */
    .container.my-3 {
        max-width: 600px;
        padding: 2rem 1rem;
    }

    /* 카드 스타일 */
    .post-form {
        background: #fff;
        padding: 2rem;
        border-radius: 12px;
        box-shadow: 0 2px 12px rgba(0,0,0,0.08);
        margin-top: 1.5rem;
    }

    /* 헤더 스타일 */
    .row.my-3 h4 {
        color: #2c3e50;
        font-size: 1.5rem;
        margin: 0;
    }

    .text-right {
        text-align: right;
    }

    .text-right a {
        color: #0d6efd;
        text-decoration: none;
        font-weight: 500;
    }

    .text-right a:hover {
        text-decoration: underline;
    }

    /* 입력 필드 스타일 */
    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: #495057;
        font-weight: 500;
        font-size: 0.95rem;
    }

    .form-control {
        border: 1px solid #dee2e6;
        border-radius: 8px;
        padding: 0.75rem 1rem;
        font-size: 0.95rem;
        transition: all 0.2s ease;
        background-color: #fff;
    }

    .form-control:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.25rem rgba(13,110,253,.15);
    }

    /* 셀렉트 박스 스타일 */
    select.form-control {
        appearance: none;
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3e%3cpath fill='none' stroke='%23343a40' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M2 5l6 6 6-6'/%3e%3c/svg%3e");
        background-repeat: no-repeat;
        background-position: right 0.75rem center;
        background-size: 16px 12px;
    }

    select.form-control:disabled {
        background-color: #e9ecef;
        cursor: not-allowed;
    }

    /* 버튼 스타일 */
    .btn-primary {
        width: 100%;
        padding: 0.75rem;
        font-size: 1rem;
        font-weight: 500;
        border-radius: 8px;
        border: none;
        margin-top: 1rem;
        transition: all 0.2s ease;
    }

    .btn-primary:hover {
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(13,110,253,0.15);
    }

    /* 모바일 대응 */
    @media (max-width: 767.98px) {
        .container.my-3 {
            padding: 1rem;
        }

        .post-form {
            padding: 1.5rem;
        }

        .row.my-3 {
            margin-bottom: 1rem;
        }

        .row.my-3 h4 {
            font-size: 1.25rem;
        }

        .text-right span {
            font-size: 0.9rem;
        }

        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-group label {
            font-size: 0.9rem;
        }

        .form-control {
            font-size: 0.9rem;
            padding: 0.625rem 0.875rem;
        }

        .btn-primary {
            padding: 0.625rem;
            font-size: 0.95rem;
        }
    }

    /* 애니메이션 */
    .post-form {
        animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* 플레이스홀더 스타일 */
    .form-control::placeholder {
        color: #adb5bd;
        font-size: 0.9rem;
    }

    /* 에러 메시지 스타일 */
    .alert-danger {
        border-radius: 8px;
        font-size: 0.9rem;
        margin-bottom: 1.5rem;
    }
</style>


{% endblock %}