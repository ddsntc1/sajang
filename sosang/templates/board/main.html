{% extends "base.html" %}
{% load board_filter %}

{% block main_head %}
<div class="py-5 text-white" style="background:rgb(245, 183, 129) ;">
    <div class="container">
        <div class="row justify-content-center text-center">
            <div class="col-md-9">
                <h1 class="display-3 fw-bold mb-4">ë‚˜ë„ì‚¬ì¥ ì»¤ë®¤ë‹ˆí‹°</h1>
                <p class="lead mb-4"><i class="fas fa-users"></i> ìì˜ì—…, 1ì¸ì‚¬ì—…, ì†Œìƒê³µì¸, ë§ˆì¼€íŒ… ë“± ì‚¬ì—… ìš´ì˜ì— ëŒ€í•œ ê³ ë¯¼ì„ ë‚˜ëˆ„ê³ , í•¨ê»˜ ì„±ì¥í•˜ëŠ” ê³µê°„ì…ë‹ˆë‹¤.</p>
                <p class="lead mb-4"><i class="fas fa-chart-line"></i> íšŒì› ìˆ˜ : {{user_count}}</p>
                {% if user.is_authenticated %}
                <a href="{% url 'board:category_questions' slug='all' %}" class="btn btn-lg btn-warning shadow-lg">ì „ì²´ê²Œì‹œíŒ</a>
                
                {% else %}
                <a href="{% url 'common:login' %}" class="btn btn-lg btn-warning shadow-lg">ë¡œê·¸ì¸í•˜ê¸°</a>
                {% endif %}
            </div>
        </div>
    </div>
</div>
<script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>

{% endblock main_head %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <!-- Main Content -->
        <div class="col-md-9">
            <!-- Main Hero Poster Section -->
            {% if hero_advertisement %}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card hero-banner bg-light">
                        <a href="{{ hero_advertisement.external_link }}" target="_blank" class="d-block">
                            <div class="position-relative hero-container">
                                <img src="{{ hero_advertisement.main_banner.url }}" 
                                    class="img-fluid" 
                                    alt="{{ hero_advertisement.title }}" 
                                    loading = 'lazy'>
                                <div class="position-absolute top-0 end-0 m-3">
                                    <span class="badge bg-light text-dark opacity-75">AD</span>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            {% endif %}
            <!-- Main Banner Advertisement Section -->  
            {% if main_advertisements %}
            <div class="row mb-4">
                <div class="col-12">
                    <div class="card">
                        <div class="card-header bg-light">
                            <h5 class="mb-0">ğŸ“¢ ë°°ë„ˆ ê´‘ê³ </h5>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                {% for ad in main_advertisements %}
                                <div class="col-6">
                                    <div class="card h-100 shadow-sm banner-card">
                                        <a href="{{ ad.external_link }}" target="_blank" class="text-decoration-none">
                                            <div class="position-relative">
                                                <img src="{{ ad.main_banner.url }}" 
                                                    class="img-fluid w-100"
                                                    alt="{{ ad.title }}" 
                                                    style="object-fit: contain; aspect-ratio: 16 / 9;"
                                                    loading="lazy">
                                                <!-- í•„ìš”ì‹œ contain(ì•ˆì˜ë¦¼&ë¹ˆê³µê°„) <-> cover(ì˜ë¦¼ê°€ëŠ¥ & ê½‰ì°¸) ë³€ê²½ -->
                                                <div class="position-absolute top-0 end-0 p-2">
                                                    <span class="badge bg-light text-dark opacity-75">AD</span>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Popular Posts Section -->
            <div class="row">
                <!-- Hot Issues/Overall Popular Posts -->
                <div class="col-12 mb-4">
                    <div class="card shadow-sm">
                        <div class="card-header text-dark position-relative hot-posts-header">
                            <h5 class="mb-0 d-flex align-items-center">
                                <span class="fire-icon me-2">ğŸ”¥</span>
                                ì‹¤ì‹œê°„ ì¸ê¸°ê¸€
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                {% for post in hot_posts %}
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center mb-2">
                                        <span class="rank-badge me-2">{{ forloop.counter }}</span>
                                        <a href="{% url 'board:detail' post.id %}" class="post-link">
                                            {{ post.subject }}
                                            <small class="like-count ms-2">
                                                <i class="fas fa-heart"></i> {{ post.up_voter.count }}
                                            </small>
                                        </a>
                                    </div>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Latest News Section -->
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header bg-info text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">ğŸ“¢ ì •ë¶€ì§€ì›ì‚¬ì—… ì†Œì‹</h5>
                            <a href="{% url 'board:category_questions' 'gov' %}" class="btn btn-sm btn-light">ë”ë³´ê¸°</a>
                        </div>
                        <div class="card-body">
                            {% for news in government_news %}
                            <div class="col-mb-3">
                                <div class="d-flex align-items-center mb-2">
                                    <span class="badge bg-info me-2">New</span>
                                    <a href="{% url 'board:detail' news.id %}" class="post-link">
                                        {{ news.subject }}
                                        <small class="like-count ms-2">
                                            <i class="fas fa-heart"></i> {{ news.up_voter.count }}
                                        </small>
                                        <em><small class="text-muted ms-4">{{ news.create_date|date:"Y.m.d" }}</small></em>
                                    </a>
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>

                <!-- Business Trends Section -->
                <div class="col-md-6 mb-4">
                    <div class="card h-100">
                        <div class="card-header bg-success text-white d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">ğŸ“ˆ ìµœì‹  ë‰´ìŠ¤</h5>
                            <a href="{% url 'board:category_questions' 'gov' %}" class="btn btn-sm btn-light">ë”ë³´ê¸°</a>
                        </div>
                        <div class="card-body">
                            {% for trend in business_trends %}
                            <div class="mb-3">
                                <div class="d-flex align-items-center">
                                    <span class="badge bg-success me-2">{{ trend.category }}</span>
                                    <a href="#" class="text-decoration-none">{{ trend.title }}</a>
                                </div>
                                <small class="text-muted ms-4">{{ trend.date|date:"Y.m.d" }}</small>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Side Advertisement Section -->
            {% if side_advertisements %}
            <div class="horizontal-scroll-container mt-4">
                {% for ad in side_advertisements %}
                <div class="ad-item">
                    <div class="card">
                        <div class="card-body p-0">
                            <small class="text-muted position-absolute p-2">sponsored</small>
                            <a href="{% url 'board:detail' question_id=ad.question.id %}" target="_blank" class="d-block">
                                <img src="{{ ad.side_banner.url }}" 
                                    alt="{{ ad.question.subject }}" 
                                    class="ad-image"
                                    loading="lazy">
                            </a>
                        </div>
                        {% if ad.title %}
                        <div class="card-footer">
                            <small>{{ ad.title }}</small>
                        </div>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}


        </div>
    </div>
</div>

<style>

.hot-posts-header {
    background-color: #ffcc00;
    border-bottom: none;
    padding: 1rem 1.25rem;
}

.fire-icon {
    font-size: 1.2rem;
}

.rank-badge {
    background-color: #ffcc00;
    color: #333;
    font-weight: bold;
    padding: 2px 8px;
    border-radius: 4px;
    min-width: 24px;
    text-align: center;
    font-size: 0.9rem;
}

.post-link {
    color: #333;
    text-decoration: none;
    transition: color 0.2s ease;
    font-weight: 500;
}

.post-link:hover {
    color: #ffcc00;
}

.like-count {
    color: #666;
}

.like-count i {
    color: #ff4444;
    font-size: 0.8rem;
}

.hero-banner {
    transition: transform 0.2s ease-in-out;
    height: 800px; /* ê³ ì • ë†’ì´ ì„¤ì • */
    overflow: hidden; /* ë‚´ìš©ì´ ë„˜ì¹˜ì§€ ì•Šë„ë¡ */
}

.hero-container {
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: #f8f9fa; /* ì´ë¯¸ì§€ê°€ ì±„ìš°ì§€ ì•ŠëŠ” ê³µê°„ì˜ ë°°ê²½ìƒ‰ */
}

.hero-container img {
    max-height: 800px;
    width: auto;
    object-fit: contain;
}

.hero-banner:hover {
    transform: scale(1.01);
}


@media (max-width: 767px) {
    .hero-banner {
        height: auto;
    }
 
    .hero-container {
        height: auto;
    }
 
    .hero-container img {
        width: 100%;
        max-height: none;
        height: auto;
    }
    .banner-card img {
        width: 100%;
        height: auto;
        min-height: 100px; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
        background: white;
    }

    /* ì¹´ë“œ í—¤ë” í°íŠ¸ í¬ê¸° ì¡°ì • */
    .card-header h5 {
        font-size: 1rem;
    }

    /* ì¸ê¸°ê¸€, ì†Œì‹ í°íŠ¸ í¬ê¸° */
    .post-link {
        font-size: 0.9rem;
    }

    .like-count {
        font-size: 0.75rem;
    }

    .text-muted {
        font-size: 0.75rem;
    }
 }

 .horizontal-scroll-container {
    display: flex;
    overflow-x: auto;
    gap: 16px; /* ê´‘ê³  ê°„ì˜ ê°„ê²© */
    padding: 8px;
    scrollbar-width: thin; /* ìŠ¤í¬ë¡¤ë°” ë‘ê»˜ */
    -ms-overflow-style: none; /* ìŠ¤í¬ë¡¤ë°” ì œê±° (IE/Edge) */
}

.horizontal-scroll-container::-webkit-scrollbar {
    height: 6px; /* ìŠ¤í¬ë¡¤ë°” ë†’ì´ */
    background-color: #f5f5f5; /* ìŠ¤í¬ë¡¤ë°” ë°°ê²½ìƒ‰ */
}

.horizontal-scroll-container::-webkit-scrollbar-thumb {
    background-color: #ccc; /* ìŠ¤í¬ë¡¤ë°” ìƒ‰ìƒ */
    border-radius: 3px; /* ìŠ¤í¬ë¡¤ë°” ëª¨ì„œë¦¬ */
}

.ad-item {
    flex: 0 0 auto; /* ê´‘ê³  ì•„ì´í…œì˜ í¬ê¸° ê³ ì • */
    width: 200px; /* ê´‘ê³  ì¹´ë“œì˜ ê³ ì • ë„ˆë¹„ */
    height: 200px; /* ê´‘ê³  ì¹´ë“œì˜ ê³ ì • ë†’ì´ */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* ì•½ê°„ì˜ ê·¸ë¦¼ì íš¨ê³¼ */
    border-radius: 8px; /* ë¶€ë“œëŸ¬ìš´ ëª¨ì„œë¦¬ */
    background-color: #fff; /* ì¹´ë“œ ë°°ê²½ìƒ‰ */
    overflow: hidden; /* ë‚´ìš©ë¬¼ì´ ë„˜ì¹˜ì§€ ì•Šë„ë¡ ì„¤ì • */
    display: flex; /* Flexbox ì‚¬ìš© */
    flex-direction: column;
    align-items: center; /* ì„¸ë¡œ ì¤‘ì•™ ì •ë ¬ */
    justify-content: center; /* ê°€ë¡œ ì¤‘ì•™ ì •ë ¬ */
}

.ad-item .card {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column;
}
.image-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center; /* ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
    align-items: center; /* ìˆ˜ì§ ì¤‘ì•™ ì •ë ¬ */
    overflow: hidden; /* ì´ë¯¸ì§€ë¥¼ ê°ì‹¸ëŠ” ì˜ì—­ ì™¸ë¶€ ì˜ë¦¼ */
}
.ad-image {
    width: 100%;
    height: 100%;
    object-fit: contain; /* ì´ë¯¸ì§€ê°€ ì¹´ë“œ ì˜ì—­ì„ ì™„ì „íˆ ì±„ìš°ë„ë¡ ì„¤ì • */
    object-position: center; /* ì´ë¯¸ì§€ì˜ ì¤‘ì•™ ë¶€ë¶„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ë¦¼ */
}
</style>

{% endblock %}
